{"ast":null,"code":"// src/Home.tsx\nimport React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import{useNavigate}from'react-router-dom';import LogoutBanner from'./Logout';import{jwtDecode}from'jwt-decode';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const navigate=useNavigate();const token=localStorage.getItem('token');const[userType,setUserType]=useState(null);const isTokenValid=token=>{if(!token)return false;try{const decoded=jwtDecode(token);// Decode the JWT\nconst currentTime=Date.now()/1000;// Current time in seconds TODO fix\nreturn decoded.exp>currentTime;// Check if the token is expired\n}catch(error){console.error(\"Token validation error:\",error);return false;}};const handleLogout=()=>{// Clear any stored user data (e.g., token)\nlocalStorage.removeItem('token');// Redirect to login page or wherever you want\nnavigate('/login');};const tokenIsValid=isTokenValid(token);// If token is not valid, redirect to login\nuseEffect(()=>{if(!tokenIsValid){navigate('/login');}else{if(token){// If token is valid, extract user type\nconst decoded=jwtDecode(token);setUserType(decoded.userType);// Assuming userType is in the token\n}}},[token,navigate,tokenIsValid]);return/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',padding:'20px'},children:[tokenIsValid&&/*#__PURE__*/_jsx(LogoutBanner,{onLogout:handleLogout}),/*#__PURE__*/_jsx(\"h1\",{children:\"Welcome to the Book Store\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your one-stop destination for exploring and borrowing books!\"}),userType==='Librarian'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Hello Librarian!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage your library and assist customers.\"}),/*#__PURE__*/_jsx(Link,{to:\"/manage-books\",children:/*#__PURE__*/_jsx(\"button\",{style:{margin:'10px'},children:\"Manage Books\"})})]}),userType==='Customer'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Hello Customer!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Browse and borrow your favorite books.\"}),/*#__PURE__*/_jsx(Link,{to:\"/browse-books\",children:/*#__PURE__*/_jsx(\"button\",{style:{margin:'10px'},children:\"Browse Books\"})})]})]});};export default Home;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","LogoutBanner","jwtDecode","jsx","_jsx","jsxs","_jsxs","Home","navigate","token","localStorage","getItem","userType","setUserType","isTokenValid","decoded","currentTime","Date","now","exp","error","console","handleLogout","removeItem","tokenIsValid","style","textAlign","padding","children","onLogout","to","margin"],"sources":["/Users/richarddrum/TroyWebTechnicalAssessment/Library/library-frontend/src/components/Home.tsx"],"sourcesContent":["// src/Home.tsx\nimport React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useNavigate } from 'react-router-dom';\nimport LogoutBanner from './Logout';\nimport { jwtDecode } from 'jwt-decode';\n\nconst Home: React.FC = () => {\n    const navigate = useNavigate();\n    const token = localStorage.getItem('token');\n    const [userType, setUserType] = useState<string | null>(null);\n\n    const isTokenValid = (token: string | null) => {\n        if (!token) return false;\n\n        try {\n            const decoded: any = jwtDecode(token); // Decode the JWT\n            const currentTime = Date.now() / 1000; // Current time in seconds TODO fix\n            return decoded.exp > currentTime; // Check if the token is expired\n        } catch (error) {\n            console.error(\"Token validation error:\", error);\n            return false;\n        }\n    };\n\n    const handleLogout = () => {\n        // Clear any stored user data (e.g., token)\n        localStorage.removeItem('token');\n        // Redirect to login page or wherever you want\n        navigate('/login');\n    };\n\n    const tokenIsValid = isTokenValid(token);\n    // If token is not valid, redirect to login\n    useEffect(() => {\n        if (!tokenIsValid) {\n            navigate('/login');\n        } else {\n            if(token){\n                // If token is valid, extract user type\n                const decoded: any = jwtDecode(token);\n                setUserType(decoded.userType); // Assuming userType is in the token\n            }\n        }\n    }, [token, navigate, tokenIsValid]);\n\n    return (\n        <div style={{ textAlign: 'center', padding: '20px' }}>\n            {tokenIsValid && <LogoutBanner onLogout={handleLogout} />}\n            \n            <h1>Welcome to the Book Store</h1>\n            <p>Your one-stop destination for exploring and borrowing books!</p>\n\n            {/* Display different content based on user type */}\n            {userType === 'Librarian' && (\n                <div>\n                    <h2>Hello Librarian!</h2>\n                    <p>Manage your library and assist customers.</p>\n                    <Link to=\"/manage-books\">\n                        <button style={{ margin: '10px' }}>Manage Books</button>\n                    </Link>\n                </div>\n            )}\n            {userType === 'Customer' && (\n                <div>\n                    <h2>Hello Customer!</h2>\n                    <p>Browse and borrow your favorite books.</p>\n                    <Link to=\"/browse-books\">\n                        <button style={{ margin: '10px' }}>Browse Books</button>\n                    </Link>\n                </div>\n            )}\n        </div>\n\n    );\n};\n\nexport default Home;\n"],"mappings":"AAAA;AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,IAAI,KAAQ,kBAAkB,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,YAAY,KAAM,UAAU,CACnC,OAASC,SAAS,KAAQ,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEvC,KAAM,CAAAC,IAAc,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAAC,QAAQ,CAAGR,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAS,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGf,QAAQ,CAAgB,IAAI,CAAC,CAE7D,KAAM,CAAAgB,YAAY,CAAIL,KAAoB,EAAK,CAC3C,GAAI,CAACA,KAAK,CAAE,MAAO,MAAK,CAExB,GAAI,CACA,KAAM,CAAAM,OAAY,CAAGb,SAAS,CAACO,KAAK,CAAC,CAAE;AACvC,KAAM,CAAAO,WAAW,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CAAE;AACvC,MAAO,CAAAH,OAAO,CAACI,GAAG,CAAGH,WAAW,CAAE;AACtC,CAAE,MAAOI,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C,MAAO,MAAK,CAChB,CACJ,CAAC,CAED,KAAM,CAAAE,YAAY,CAAGA,CAAA,GAAM,CACvB;AACAZ,YAAY,CAACa,UAAU,CAAC,OAAO,CAAC,CAChC;AACAf,QAAQ,CAAC,QAAQ,CAAC,CACtB,CAAC,CAED,KAAM,CAAAgB,YAAY,CAAGV,YAAY,CAACL,KAAK,CAAC,CACxC;AACAZ,SAAS,CAAC,IAAM,CACZ,GAAI,CAAC2B,YAAY,CAAE,CACfhB,QAAQ,CAAC,QAAQ,CAAC,CACtB,CAAC,IAAM,CACH,GAAGC,KAAK,CAAC,CACL;AACA,KAAM,CAAAM,OAAY,CAAGb,SAAS,CAACO,KAAK,CAAC,CACrCI,WAAW,CAACE,OAAO,CAACH,QAAQ,CAAC,CAAE;AACnC,CACJ,CACJ,CAAC,CAAE,CAACH,KAAK,CAAED,QAAQ,CAAEgB,YAAY,CAAC,CAAC,CAEnC,mBACIlB,KAAA,QAAKmB,KAAK,CAAE,CAAEC,SAAS,CAAE,QAAQ,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAAC,QAAA,EAChDJ,YAAY,eAAIpB,IAAA,CAACH,YAAY,EAAC4B,QAAQ,CAAEP,YAAa,CAAE,CAAC,cAEzDlB,IAAA,OAAAwB,QAAA,CAAI,2BAAyB,CAAI,CAAC,cAClCxB,IAAA,MAAAwB,QAAA,CAAG,8DAA4D,CAAG,CAAC,CAGlEhB,QAAQ,GAAK,WAAW,eACrBN,KAAA,QAAAsB,QAAA,eACIxB,IAAA,OAAAwB,QAAA,CAAI,kBAAgB,CAAI,CAAC,cACzBxB,IAAA,MAAAwB,QAAA,CAAG,2CAAyC,CAAG,CAAC,cAChDxB,IAAA,CAACL,IAAI,EAAC+B,EAAE,CAAC,eAAe,CAAAF,QAAA,cACpBxB,IAAA,WAAQqB,KAAK,CAAE,CAAEM,MAAM,CAAE,MAAO,CAAE,CAAAH,QAAA,CAAC,cAAY,CAAQ,CAAC,CACtD,CAAC,EACN,CACR,CACAhB,QAAQ,GAAK,UAAU,eACpBN,KAAA,QAAAsB,QAAA,eACIxB,IAAA,OAAAwB,QAAA,CAAI,iBAAe,CAAI,CAAC,cACxBxB,IAAA,MAAAwB,QAAA,CAAG,wCAAsC,CAAG,CAAC,cAC7CxB,IAAA,CAACL,IAAI,EAAC+B,EAAE,CAAC,eAAe,CAAAF,QAAA,cACpBxB,IAAA,WAAQqB,KAAK,CAAE,CAAEM,MAAM,CAAE,MAAO,CAAE,CAAAH,QAAA,CAAC,cAAY,CAAQ,CAAC,CACtD,CAAC,EACN,CACR,EACA,CAAC,CAGd,CAAC,CAED,cAAe,CAAArB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}