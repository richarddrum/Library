{"ast":null,"code":"// src/Layout.tsx\nimport React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import{isTokenValid}from'../utilities/AuthenticationUtils';import{jwtDecode}from'jwt-decode';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Layout=_ref=>{let{children}=_ref;const navigate=useNavigate();const handleLogout=()=>{localStorage.removeItem('token');navigate('/login');};const handleManageBooks=()=>{navigate('/manage-books');};const handleBrowseBooks=()=>{navigate('/browse-books');};const handleLogin=()=>{navigate('/login');};const handleRegister=()=>{navigate('/register');};const token=localStorage.getItem('token');const[userType,setUserType]=useState(null);const tokenIsValid=isTokenValid(token);// If token is not valid, redirect to login\nuseEffect(()=>{if(tokenIsValid&&token){const decoded=jwtDecode(token);setUserType(decoded.userType);}},[token,navigate,tokenIsValid]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:!tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleRegister,children:\"Register\"})}),/*#__PURE__*/_jsx(\"li\",{children:!tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,children:\"Login\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&userType==='Librarian'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleManageBooks,children:\" Manage Books\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&userType==='Customer'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleBrowseBooks,children:\" Browse Books\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})})]})}),/*#__PURE__*/_jsx(\"main\",{children:children})]});};export default Layout;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","isTokenValid","jwtDecode","jsx","_jsx","jsxs","_jsxs","Layout","_ref","children","navigate","handleLogout","localStorage","removeItem","handleManageBooks","handleBrowseBooks","handleLogin","handleRegister","token","getItem","userType","setUserType","tokenIsValid","decoded","to","onClick"],"sources":["/Users/richarddrum/TroyWebTechnicalAssessment/Git/Library/library-frontend/src/components/Layout.tsx"],"sourcesContent":["// src/Layout.tsx\nimport React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { isTokenValid } from '../utilities/AuthenticationUtils';\nimport { jwtDecode } from 'jwt-decode';\n\nconst Layout: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    const navigate = useNavigate();\n\n    const handleLogout = () => {\n        localStorage.removeItem('token'); \n        navigate('/login'); \n    };\n    const handleManageBooks = () => {\n        navigate('/manage-books'); \n    };\n    const handleBrowseBooks = () => {\n        navigate('/browse-books'); \n    };\n    const handleLogin = () => {\n        navigate('/login'); \n    };\n    const handleRegister = () => {\n        navigate('/register'); \n    };\n    const token = localStorage.getItem('token');\n    const [userType, setUserType] = useState<string | null>(null);\n    const tokenIsValid = isTokenValid(token);\n    // If token is not valid, redirect to login\n    useEffect(() => {\n        if (tokenIsValid && token)\n        {\n            const decoded: any = jwtDecode(token);\n            setUserType(decoded.userType); \n        }\n    }, [token, navigate, tokenIsValid]);\n    \n    return (\n        <div>\n            <nav>\n                <ul>\n                    <li>\n                        <Link to=\"/\">Home</Link>\n                    </li>\n                    <li>\n                        {!tokenIsValid && (<button onClick={handleRegister}>Register</button>)}\n                    </li>\n                    <li>\n                        {!tokenIsValid && (<button onClick={handleLogin}>Login</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && userType === 'Librarian' && (<button onClick={handleManageBooks}> Manage Books</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && userType === 'Customer' && (<button onClick={handleBrowseBooks}> Browse Books</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && (<button onClick={handleLogout}>Logout</button>)}\n                    </li>\n                </ul>\n            </nav>\n            <main>\n                {children}\n            </main>\n        </div>\n    );\n};\n\nexport default Layout;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}