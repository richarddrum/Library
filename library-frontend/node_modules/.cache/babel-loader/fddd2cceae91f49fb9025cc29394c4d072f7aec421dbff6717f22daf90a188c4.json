{"ast":null,"code":"// src/Layout.tsx\nimport React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{isTokenValid}from'../utilities/AuthenticationUtils';import{jwtDecode}from'jwt-decode';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Layout=_ref=>{let{children}=_ref;const navigate=useNavigate();const handleHome=()=>{navigate('/');};const handleLogout=()=>{localStorage.removeItem('token');navigate('/login');};const handleManageBooks=()=>{navigate('/manage-books');};const handleBrowseBooks=()=>{navigate('/browse-books');};const handleLogin=()=>{navigate('/login');};const handleRegister=()=>{navigate('/signup');};const handleFeatured=()=>{navigate('/featured-books');};const token=localStorage.getItem('token');const[userType,setUserType]=useState(null);const tokenIsValid=isTokenValid(token);// If token is not valid, redirect to login\nuseEffect(()=>{if(tokenIsValid&&token){const decoded=jwtDecode(token);setUserType(decoded.userType);}},[token,navigate,tokenIsValid]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:handleHome,children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:!tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleRegister,children:\"Register\"})}),/*#__PURE__*/_jsx(\"li\",{children:!tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,children:\"Login\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleFeatured,children:\"Register\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&userType==='Librarian'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleManageBooks,children:\" Manage Books\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&userType==='Customer'&&/*#__PURE__*/_jsx(\"button\",{onClick:handleBrowseBooks,children:\" Browse Books\"})}),/*#__PURE__*/_jsx(\"li\",{children:tokenIsValid&&/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})})]})}),/*#__PURE__*/_jsx(\"main\",{children:children})]});};export default Layout;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","isTokenValid","jwtDecode","jsx","_jsx","jsxs","_jsxs","Layout","_ref","children","navigate","handleHome","handleLogout","localStorage","removeItem","handleManageBooks","handleBrowseBooks","handleLogin","handleRegister","handleFeatured","token","getItem","userType","setUserType","tokenIsValid","decoded","onClick"],"sources":["/Users/richarddrum/TroyWebTechnicalAssessment/Library/library-frontend/src/components/Layout.tsx"],"sourcesContent":["// src/Layout.tsx\nimport React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { isTokenValid } from '../utilities/AuthenticationUtils';\nimport { jwtDecode } from 'jwt-decode';\n\nconst Layout: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    const navigate = useNavigate();\n\n    const handleHome = () => {\n        navigate('/'); \n    };\n    const handleLogout = () => {\n        localStorage.removeItem('token'); \n        navigate('/login'); \n    };\n    const handleManageBooks = () => {\n        navigate('/manage-books'); \n    };\n    const handleBrowseBooks = () => {\n        navigate('/browse-books'); \n    };\n    const handleLogin = () => {\n        navigate('/login'); \n    };\n    const handleRegister = () => {\n        navigate('/signup'); \n    };\n    const handleFeatured = () => {\n        navigate('/featured-books'); \n    };\n    const token = localStorage.getItem('token');\n    const [userType, setUserType] = useState<string | null>(null);\n    const tokenIsValid = isTokenValid(token);\n    // If token is not valid, redirect to login\n    useEffect(() => {\n        if (tokenIsValid && token)\n        {\n            const decoded: any = jwtDecode(token);\n            setUserType(decoded.userType); \n        }\n    }, [token, navigate, tokenIsValid]);\n    \n    return (\n        <div>\n            <nav>\n                <ul>\n                    <li>\n                        <button onClick={handleHome}>Home</button>\n                    </li>\n                    <li>\n                        {!tokenIsValid && (<button onClick={handleRegister}>Register</button>)}\n                    </li>\n                    <li>\n                        {!tokenIsValid && (<button onClick={handleLogin}>Login</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && (<button onClick={handleFeatured}>Register</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && userType === 'Librarian' && (<button onClick={handleManageBooks}> Manage Books</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && userType === 'Customer' && (<button onClick={handleBrowseBooks}> Browse Books</button>)}\n                    </li>\n                    <li>\n                        {tokenIsValid && (<button onClick={handleLogout}>Logout</button>)}\n                    </li>\n                </ul>\n            </nav>\n            <main>\n                {children}\n            </main>\n        </div>\n    );\n};\n\nexport default Layout;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}